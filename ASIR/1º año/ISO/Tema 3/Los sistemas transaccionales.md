Una transacción es un conjunto de operaciones en las que se ejecutan todas ellas o no se ejecuta ninguna. Las órdenes de ejecución se envían todas una a una, pero el efecto se realiza al final, mediante una única instrucción: commit (realizar la transacción) o rollback (deshacer la transacción). Por defecto, una transacción no finalizada debe llevar un rollback automático.
A nivel de sistemas operativos piense, por ejemplo, en un programa instalador que necesite realizar varias acciones antes de finalizar: copiar ficheros, borrar otros, renombrar otros, etc. y dicho proceso se puede complicar si se produce una caída de la máquina o un simple corte de luz. Por ello, cuando el programa instalador considere que ha llegado al final, deberá decidir si aplica todos los cambios o deshace todo el proceso para evitar una corrupción del sistema.
El concepto de transacción no es nuevo, ya que se utiliza desde hace muchos años, sobre todo en las bases de datos. Lo que sí es reciente es el aplicarlo en el contexto de los sistemas de archivos.
En un sistema de archivos transaccional el estado del sistema de archivos siempre es coherente en el disco. Los sistemas de archivos tradicionales sobrescriben los datos en el momento y si el equipo se queda sin alimentación, por ejemplo, entre el momento en que se asigna un bloque de datos y se vincula a un directorio, el sistema de archivos se quedará en un estado incoherente.
Este problema se intentaba solucionar verificando el estado del sistema de archivos e intentando reparar cualquier incoherencia del proceso, pero era un problema que daba muchos quebraderos de cabeza a los administradores y nunca garantizaba la solución a todos los problemas que pudiera haber.
Posteriormente, los sistemas de archivos incorporaron el concepto de registro de diario (Journaling). Dicho registro guarda las acciones en un diario aparte, el cual se puede volver a reproducir con seguridad si el sistema se bloquea. Este proceso supone cargas innecesarias al sistema, porque los datos se deben escribir dos veces y a menudo provoca una nueva fuente de problemas, por ejemplo, no poder volver a reproducir el registro de diario.
Con un sistema de archivos transaccional, los datos se administran mediante la semántica copia por escritura (copy-on-write, COW). Los datos nunca se sobrescriben y ninguna secuencia de operaciones se compromete ni se ignora por completo. Este mecanismo hace que el sistema de archivos nunca pueda dañarse por una interrupción imprevista de la alimentación o un bloqueo del sistema.
Para ello, cuando haya que modificar algún archivo, se escriben sus datos en un nuevo bloque en lugar de sobrescribirlos y cuando todo esté correcto, se borrará el bloque antiguo con los datos iniciales.
La técnica de copia por escritura ofrece varias ventajas:
•El estado en disco siempre es válido.
•Las copias de seguridad son coherentes y fiables.
•Se pueden deshacer las modificaciones de los datos hasta un momento determinado.
Sistemas de archivos que utilizan esta de técnica de COW son: ext3cow y Btrfs para Linux, ZFS para Solaris.
Además, las versiones nuevas los sistemas de archivos como NTFS, ReFS, ext3fs, ext4fs y HFS+ incorporanmetodologías empleados métodos empleados en sistemas transaccionales como el Registro de Diario (o Journaling), o el de copia en escritura (COW), por tanto, se pueden considerar como transaccionales.